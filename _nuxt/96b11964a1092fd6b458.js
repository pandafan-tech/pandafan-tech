(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{316:function(e,t,n){var content=n(319);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(42).default)("4b9d6588",content,!0,{sourceMap:!1})},317:function(e,t,n){var content=n(321);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(42).default)("3fdd0566",content,!0,{sourceMap:!1})},318:function(e,t,n){"use strict";var o=n(316);n.n(o).a},319:function(e,t,n){(e.exports=n(41)(!1)).push([e.i,'.hub[data-v-169793d7]{color:#fff;margin:0;font-family:sans-serif;font-weight:700;font-size:2rem}.hub span[data-v-169793d7]:nth-child(2){background:#f90;color:#000;border-radius:5px;padding:0 .5rem .1rem}.hub span[data-v-169793d7]:nth-child(3){margin-top:5px;display:block;font-size:.8rem;font-weight:500}.hub span[data-v-169793d7]:nth-child(3):before{content:"";display:block}',""])},320:function(e,t,n){"use strict";var o=n(317);n.n(o).a},321:function(e,t,n){(e.exports=n(41)(!1)).push([e.i,".container{background:#2c3e50;margin:0 auto;min-height:100vh;display:flex;justify-content:center;align-items:center;text-align:center}.login-container{position:fixed}@media screen and (max-width:450px){.login-container{top:10vh}}@media screen and (min-height:1200px){.login-container{top:30vh}}.login-container .lang,.login-container .reset{color:#f4f7fc;font-size:1.5rem;cursor:pointer}.login-container .lang{position:fixed;top:1rem;right:1rem}.login-container .reset{position:fixed;bottom:1rem;left:1rem}.login-container .reg{margin-top:2.5rem;text-align:center;color:#95a5a6}.login-container .reg *{color:#f4f7fc}.login-container .title{color:#f4f7fc;display:block;font-size:2.5rem}.login-container .subtitle{color:#f4f7fc;font-size:1.5rem}.login-container .el-form{display:block;margin-top:3rem}.login-container .el-form input{background:transparent;color:#f4f7fc;text-align:center;border:none;border-bottom:1px solid #95a5a6;border-radius:0;padding:2rem;font-size:1.2rem}.login-container .el-form input:focus,.login-container .el-form input:hover{border-color:#1abc9c}.login-container .el-form .el-button{margin-top:2rem;font-size:1rem;padding:.5rem 3rem;border-radius:50px;border:none}.login-container .el-form .el-button[type=primary],.login-container .el-form .el-button[type=success]{background:#1abc9c}.login-container .el-form a{margin-top:1rem}.login-container .token-text{margin-top:1.5rem}.login-container .token-text a{padding-bottom:0}",""])},322:function(e,t,n){"use strict";n.r(t);n(15),n(318);var o=n(29),r={components:{Logo:Object(o.a)({},(function(){var e=this.$createElement;this._self._c;return this._m(0)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"hub"},[t("span",[this._v("Panda")]),t("span",[this._v("fan")]),t("span",[this._v("April Edition")])])}],!1,null,"169793d7",null).exports},data:function(){return{logging_in:!1,state:"login",loginInfo:{email:"",password:""},email_token:null,userSiteURL:"",user_info:null}},computed:{mail_link:function(){return"mailto:passwordchange@mg.1s.life?subject=".concat(this.email_token,":您的新密码")}},mounted:function(){this.$axios.defaults.baseURL="https://apixx.xyz/",this.$axios.defaults.headers.common["x-panda-from"]="portal",this.$intercom.boot()},methods:{switchLang:function(){var e="zh"===this.$i18n.locale?"en":"zh";this.$store.dispatch("setLocale",e),this.$i18n.locale=e},requestPasswordReset:function(){var e=this;if(!this.loginInfo.email)return this.$message({message:"请填写注册邮箱",type:"error"}),void(this.logging_in=!1);this.$store.dispatch("requestPasswordReset",{email:this.loginInfo.email}).then((function(body){alert("邮件正在发送至该邮箱，请点击邮件内链接获取新密码。\n若*30分钟*依然未收到邮件，请与网站客服联系"),e.email_token=body.email_token}),(function(t){return"illegal email"===(t=t.data).message||"not found"===t.message?e.$message({message:"未找到此邮箱地址。若您确认以此邮箱注册，请联系网站客服。",type:"error"}):e.$message({message:"服务器处理出错，请稍后重试:"+t.message,type:"error"})})).finally((function(){e.logging_in=!1}))},logIn:function(){var e=this;if(!this.loginInfo.email||!this.loginInfo.password)return this.$message({message:"请填写注册邮箱和密码",type:"error"}),void(this.logging_in=!1);this.$store.dispatch("login",this.loginInfo).then((function(body){e.user_info=body,e.$intercom.boot(body),e.$message({message:"登录成功，正在跳转...",type:"success"}),e.$store.dispatch("getUserSiteURL",body.id).then((function(u){e.userSiteURL=u,window.location=u})).catch((function(t){e.$message({message:"无法获取站点地址，请稍后重试:"+t.code||!1,type:"error"})})),e.logging_in=!1})).catch((function(t){e.logging_in=!1;var n="未知错误，可能服务器抽风了，请稍后再试 ".concat(t);return t.data&&"no such user"===t.data.message&&(n="未找到该账号"),t.data&&"email/password not match"===t.data.message&&(n="账号/密码错误"),e.$message({message:n,type:"error"})}))},onSubmit:function(){return this.logging_in=!0,"reset"===this.state?this.requestPasswordReset():this.logIn()}}},l=(n(320),Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"login-container"},[n("h1",{staticClass:"title"},[e._v("PandaFan")]),n("el-row",[n("el-form",{attrs:{"label-position":"right","label-width":"80px",model:e.loginInfo},nativeOn:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[n("el-input",{attrs:{type:"email",placeholder:e.$t("login.email"),"prefix-icon":"el-icon-caret-right"},model:{value:e.loginInfo.email,callback:function(t){e.$set(e.loginInfo,"email",t)},expression:"loginInfo.email"}}),n("el-input",{directives:[{name:"show",rawName:"v-show",value:"reset"!==e.state,expression:"state !== 'reset'"}],attrs:{type:"password",placeholder:e.$t("login.password"),"prefix-icon":"el-icon-caret-right"},model:{value:e.loginInfo.password,callback:function(t){e.$set(e.loginInfo,"password",t)},expression:"loginInfo.password"}}),n("el-button",{directives:[{name:"show",rawName:"v-show",value:"login"==e.state,expression:"state == 'login'"}],attrs:{round:"","native-type":"submit",type:"primary",loading:e.logging_in}},[e._v(e._s(e.$t("login.button")))]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:"reset"==e.state,expression:"state == 'reset'"}],attrs:{round:"","native-type":"submit",type:"warning",loading:e.logging_in}},[e._v(e._s(e.$t("login.reset.button")))])],1),n("el-card",{directives:[{name:"show",rawName:"v-show",value:e.user_info,expression:"user_info"}],staticClass:"token-text"},[n("p",[e._v("登录成功，正在跳转至... "),n("a",{attrs:{href:e.userSiteURL}},[e._v(e._s(e.userSiteURL))])])]),n("el-card",{directives:[{name:"show",rawName:"v-show",value:"reset"==e.state&&e.email_token,expression:"state == 'reset' && email_token"}],staticClass:"token-text"},[n("center",[n("h4",[e._v("重置密码的邮件已发往您的邮箱")]),n("br")]),n("h5",[e._v("若收不到重置邮件，您可以在30分钟内通过您的邮箱发送"),n("b",[e._v("标题")]),e._v("为"),n("code",[e._v(e._s(e.email_token)+":")]),e._v(" +"),n("code",[e._v("您的新密码")]),e._v("的邮件到"),n("br"),n("center",[n("a",{attrs:{href:e.mail_link}},[e._v("passwordchange@mg.1s.life")])]),n("br"),e._v("例如，发送邮件标题为"),n("code",[e._v(e._s(e.email_token)+":123123")]),e._v("将会修改您的账号密码为"),n("code",[e._v("123123")]),n("br"),e._v("邮件内容可任意或留空")],1)],1)],1),n("el-row",[n("a",{staticClass:"lang",on:{click:e.switchLang}},[e._v(e._s(e.$t("change_lang_button")))]),n("a",{directives:[{name:"show",rawName:"v-show",value:"login"==e.state,expression:"state == 'login'"}],staticClass:"reset",on:{click:function(t){e.state="reset"}}},[e._v(e._s(e.$t("login.reset.text")))]),n("a",{directives:[{name:"show",rawName:"v-show",value:"reset"==e.state,expression:"state == 'reset'"}],staticClass:"reset",on:{click:function(t){e.state="login"}}},[e._v(e._s(e.$t("login.text")))])])],1)])}),[],!1,null,null,null));t.default=l.exports}}]);